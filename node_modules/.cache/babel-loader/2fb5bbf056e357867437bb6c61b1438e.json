{"ast":null,"code":"import _slicedToArray from \"/home/mistermboy/repositories/shex-author/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/mistermboy/repositories/shex-author/src/components/EditorComp.js\";\nimport React, { useState, useContext, useEffect, useRef } from 'react';\nimport 'yashe/dist/yashe.min.css';\nimport { ShapesContext } from '../App';\nimport YASHE from 'yashe';\nimport Editor from '../entities/editor';\nimport yasheUtils from '../utils/yasheUtils';\n\nfunction EditorComp() {\n  const _useState = useState(null),\n        _useState2 = _slicedToArray(_useState, 2),\n        yashe = _useState2[0],\n        setYashe = _useState2[1];\n\n  const divRef = useRef(null);\n  const context = useContext(ShapesContext);\n  useEffect(() => {\n    if (!yashe) {\n      const options = {\n        persistent: false,\n        lineNumbers: true,\n        viewportMargin: Infinity\n      };\n      const y = YASHE(divRef.current, options);\n      y.on('blur', function () {\n        if (!y.hasErrors(y)) {\n          replaceShapes();\n          updatePrefixes();\n        }\n      });\n      y.on('humanEvent', function (shapes) {\n        Editor.getInstance().draw(shapes);\n      });\n      y.on('prefixUpdate', function () {\n        updatePrefixes();\n      });\n      y.on('themeChange', function () {//changeThemeStyle();\n      });\n      y.on('delete', function () {\n        replaceShapes();\n        updatePrefixes();\n      });\n      y.on('upload', function () {\n        //TimeOut necesary\n        setTimeout(function () {\n          replaceShapes();\n          updatePrefixes();\n        }, 10);\n      }); //Fired after a key is handled through a key map\n      //(for example \"Ctrl-Z\")\n\n      y.on('keyHandled', function () {\n        if (!y.hasErrors()) {\n          replaceShapes();\n          updatePrefixes();\n        }\n      });\n      y.setValue(yasheUtils.DEFAULT_SHAPE);\n      y.refresh();\n      setYashe(y);\n      Editor.getInstance().setYashe(y);\n      replaceShapes();\n      updatePrefixes();\n    }\n  }, [yashe]);\n\n  const replaceShapes = () => {\n    context.replaceShapes(yasheUtils.replaceShapes());\n  };\n\n  const updatePrefixes = () => {\n    context.updatePrefixes(yasheUtils.updatePrefixes());\n  };\n\n  const changeThemeStyle = () => {\n    context.changeThemeStyle();\n  };\n\n  return React.createElement(\"div\", {\n    className: \"col edit\",\n    ref: divRef,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  });\n}\n\nexport default EditorComp;","map":{"version":3,"sources":["/home/mistermboy/repositories/shex-author/src/components/EditorComp.js"],"names":["React","useState","useContext","useEffect","useRef","ShapesContext","YASHE","Editor","yasheUtils","EditorComp","yashe","setYashe","divRef","context","options","persistent","lineNumbers","viewportMargin","Infinity","y","current","on","hasErrors","replaceShapes","updatePrefixes","shapes","getInstance","draw","setTimeout","setValue","DEFAULT_SHAPE","refresh","changeThemeStyle"],"mappings":"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","sourcesContent":["import React, {useState,useContext,useEffect,useRef} from 'react';\nimport 'yashe/dist/yashe.min.css';\nimport {ShapesContext} from '../App';\n\nimport YASHE from 'yashe';\nimport Editor from '../entities/editor';\n\nimport yasheUtils from '../utils/yasheUtils';\n\nfunction EditorComp() {\n\n  const [yashe,setYashe] = useState(null);\n  const divRef = useRef(null);\n  const context = useContext(ShapesContext);\n\n  useEffect(() => {\n    \n        if (!yashe) {\n            const options = {\n                persistent:false,\n                lineNumbers: true,\n                viewportMargin: Infinity\n            }\n            \n            const y = YASHE(\n                divRef.current, \n                options)\n\n             y.on('blur', function() {\n                if(!y.hasErrors(y)){\n                    replaceShapes();\n                    updatePrefixes();\n                }\n            });\n\n\n             \n            y.on('humanEvent', function(shapes) {\n                Editor.getInstance().draw(shapes);\n            });\n\n\n            y.on('prefixUpdate', function() {\n                updatePrefixes();\n            });\n\n            y.on('themeChange', function() {\n                //changeThemeStyle();\n            });\n\n            y.on('delete', function() {\n                replaceShapes();\n                updatePrefixes();\n\n            });\n\n            y.on('upload', function() {\n                //TimeOut necesary\n                setTimeout(function(){\n                  replaceShapes();\n                  updatePrefixes();\n                }, 10);\n                \n            });\n\n           \n\n            //Fired after a key is handled through a key map\n            //(for example \"Ctrl-Z\")\n            y.on('keyHandled', function() {\n                if(!y.hasErrors()){\n                    replaceShapes();\n                    updatePrefixes();\n                }\n            });\n\n            y.setValue(yasheUtils.DEFAULT_SHAPE)\n            y.refresh();\n            setYashe(y);\n            \n            Editor.getInstance().setYashe(y);\n\n            replaceShapes();\n            updatePrefixes();\n\n            \n        }\n    }, [yashe]\n    );\n\n    const replaceShapes = ()=>{\n        context.replaceShapes(yasheUtils.replaceShapes());\n    }\n\n    const updatePrefixes = ()=>{\n        context.updatePrefixes(yasheUtils.updatePrefixes());\n    }\n\n     const changeThemeStyle = ()=>{\n         context.changeThemeStyle();\n    }\n\n\n\n    return  (<div className=\"col edit\" ref={divRef}/>);\n\n}\n\n\n\nexport default EditorComp;\n\n"]},"metadata":{},"sourceType":"module"}