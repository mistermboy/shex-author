{"ast":null,"code":"import _slicedToArray from \"/home/mistermboy/repositories/shex-author/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/mistermboy/repositories/shex-author/src/components/EditorComp.js\";\nimport React, { useState, useContext, useEffect, useRef } from 'react';\nimport 'yashe/dist/yashe.min.css';\nimport { ShapesContext } from '../App';\nimport YASHE from 'yashe';\nimport Editor from '../entities/editor';\nimport yasheUtils from '../utils/yasheUtils';\n\nfunction EditorComp() {\n  const _useState = useState(null),\n        _useState2 = _slicedToArray(_useState, 2),\n        yashe = _useState2[0],\n        setYashe = _useState2[1];\n\n  const textAreaRef = useRef(null);\n  const context = useContext(ShapesContext);\n  useEffect(() => {\n    if (!yashe) {\n      const options = {\n        persistent: false,\n        lineNumbers: true,\n        viewportMargin: Infinity\n      };\n      const y = YASHE.fromTextArea(textAreaRef.current, options);\n      y.on('blur', function () {\n        if (!y.hasErrors(y)) {\n          replaceShapes();\n          updatePrefixes();\n        }\n      });\n      y.on('humanEvent', function (shapes) {\n        Editor.getInstance().draw(shapes);\n      });\n      y.on('prefixUpdate', function () {\n        updatePrefixes();\n      });\n      y.on('themeChange', function () {\n        changeThemeStyle();\n      });\n      y.on('delete', function () {\n        replaceShapes();\n        updatePrefixes();\n      });\n      y.on('upload', function () {\n        //TimeOut necesary\n        setTimeout(function () {\n          replaceShapes();\n          updatePrefixes();\n        }, 10);\n      });\n      y.on('keydown', function () {\n        if (!y.hasErrors()) {\n          replaceShapes();\n          updatePrefixes();\n        }\n      }); //Fired after a key is handled through a key map\n      //(for example \"Ctrl-Z\")\n\n      y.on('keyHandled', function () {\n        if (!y.hasErrors()) {\n          replaceShapes();\n          updatePrefixes();\n        }\n      });\n      y.setValue(yasheUtils.DEFAULT_SHAPE);\n      y.refresh();\n      setYashe(y);\n      Editor.getInstance().setYashe(y);\n      replaceShapes();\n      updatePrefixes();\n      document.getElementsByClassName('yashe')[0].classList.add('col');\n    }\n  }, [yashe]);\n\n  const replaceShapes = () => {\n    context.replaceShapes(yasheUtils.replaceShapes());\n  };\n\n  const updatePrefixes = () => {\n    context.updatePrefixes(yasheUtils.updatePrefixes());\n  };\n\n  const changeThemeStyle = () => {\n    context.changeThemeStyle();\n  };\n\n  return React.createElement(\"div\", {\n    className: \"col show\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  }, React.createElement(\"textarea\", {\n    ref: textAreaRef,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  }));\n}\n\nexport default EditorComp;","map":{"version":3,"sources":["/home/mistermboy/repositories/shex-author/src/components/EditorComp.js"],"names":["React","useState","useContext","useEffect","useRef","ShapesContext","YASHE","Editor","yasheUtils","EditorComp","yashe","setYashe","textAreaRef","context","options","persistent","lineNumbers","viewportMargin","Infinity","y","fromTextArea","current","on","hasErrors","replaceShapes","updatePrefixes","shapes","getInstance","draw","changeThemeStyle","setTimeout","setValue","DEFAULT_SHAPE","refresh","document","getElementsByClassName","classList","add"],"mappings":"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","sourcesContent":["import React, {useState,useContext,useEffect,useRef} from 'react';\nimport 'yashe/dist/yashe.min.css';\nimport {ShapesContext} from '../App';\n\nimport YASHE from 'yashe';\nimport Editor from '../entities/editor';\n\nimport yasheUtils from '../utils/yasheUtils';\n\nfunction EditorComp() {\n\n  const [yashe,setYashe] = useState(null);\n  const textAreaRef = useRef(null);\n  const context = useContext(ShapesContext);\n\n  useEffect(() => {\n    \n        if (!yashe) {\n            const options = {\n                persistent:false,\n                lineNumbers: true,\n                viewportMargin: Infinity\n            }\n            \n            const y = YASHE.fromTextArea(\n                textAreaRef.current, \n                options)\n\n             y.on('blur', function() {\n                if(!y.hasErrors(y)){\n                    replaceShapes();\n                    updatePrefixes();\n                }\n            });\n\n\n             \n            y.on('humanEvent', function(shapes) {\n                Editor.getInstance().draw(shapes);\n            });\n\n\n            y.on('prefixUpdate', function() {\n                updatePrefixes();\n            });\n\n            y.on('themeChange', function() {\n                changeThemeStyle();\n            });\n\n            y.on('delete', function() {\n                replaceShapes();\n                updatePrefixes();\n\n            });\n\n            y.on('upload', function() {\n                //TimeOut necesary\n                setTimeout(function(){\n                  replaceShapes();\n                  updatePrefixes();\n                }, 10);\n                \n            });\n\n            y.on('keydown', function() {\n                if(!y.hasErrors()){\n                    replaceShapes();\n                    updatePrefixes();\n                }\n            });\n\n            //Fired after a key is handled through a key map\n            //(for example \"Ctrl-Z\")\n            y.on('keyHandled', function() {\n                if(!y.hasErrors()){\n                    replaceShapes();\n                    updatePrefixes();\n                }\n            });\n\n            y.setValue(yasheUtils.DEFAULT_SHAPE)\n            y.refresh();\n            setYashe(y);\n            \n            Editor.getInstance().setYashe(y);\n\n            replaceShapes();\n            updatePrefixes();\n\n            document.getElementsByClassName('yashe')[0].classList.add('col');\n        }\n    }, [yashe]\n    );\n\n    const replaceShapes = ()=>{\n        context.replaceShapes(yasheUtils.replaceShapes());\n    }\n\n    const updatePrefixes = ()=>{\n        context.updatePrefixes(yasheUtils.updatePrefixes());\n    }\n\n     const changeThemeStyle = ()=>{\n         context.changeThemeStyle();\n    }\n\n\n\n    return  (<div className='col show'>\n                <textarea ref={textAreaRef}/>\n            </div>            \n    );\n\n}\n\n\n\nexport default EditorComp;\n\n"]},"metadata":{},"sourceType":"module"}