{"ast":null,"code":"\"use strict\";\n\nvar $ = require(\"jquery\"),\n    yutils = require(\"yasgui-utils\"),\n    imgs = require(\"./imgs.js\");\n\nvar checkSyntax = function (yashe) {\n  yashe.queryValid = true;\n  yashe.clearGutter(\"gutterErrorBar\");\n  var state = null;\n\n  for (var l = 0; l < yashe.lineCount(); ++l) {\n    var precise = false;\n\n    if (!yashe.prevQueryValid) {\n      // we don't want cached information in this case, otherwise the\n      // previous error sign might still show up,\n      // even though the syntax error might be gone already\n      precise = true;\n    }\n\n    var token = yashe.getTokenAt({\n      line: l,\n      ch: yashe.getLine(l).length\n    }, precise);\n    var state = token.state;\n\n    if (state.OK == false) {\n      if (!yashe.options.syntaxErrorCheck) {\n        //the library we use already marks everything as being an error. Overwrite this class attribute.\n        $(yashe.getWrapperElement()).find(\".sp-error\").css(\"color\", \"black\"); //we don't want to gutter error, so return\n\n        return;\n      }\n\n      var warningEl = yutils.svg.getElement(imgs.warning);\n\n      if (state.errorMsg) {\n        require(\"./tooltipUtils.js\").grammarTootlip(yashe, warningEl, function () {\n          return $(\"<div/>\").text(token.state.errorMsg).html();\n        });\n      } else if (state.possibleCurrent && state.possibleCurrent.length > 0) {\n        //\t\t\t\twarningEl.style.zIndex = \"99999999\";\n        require(\"./tooltipUtils.js\").grammarTootlip(yashe, warningEl, function () {\n          var expectedEncoded = [];\n          state.possibleCurrent.forEach(function (expected) {\n            expectedEncoded.push(\"<strong style='text-decoration:underline'>\" + $(\"<div/>\").text(expected).html() + \"</strong>\");\n          });\n          return \"This line is invalid. Expected: \" + expectedEncoded.join(\", \");\n        });\n      }\n\n      warningEl.style.marginTop = \"2px\";\n      warningEl.style.marginLeft = \"2px\";\n      warningEl.className = \"parseErrorIcon\";\n      yashe.setGutterMarker(l, \"gutterErrorBar\", warningEl);\n      yashe.queryValid = false;\n      return false;\n    }\n  }\n\n  yashe.prevQueryValid = yashe.queryValid;\n  return true;\n};\n\nmodule.exports = {\n  checkSyntax: checkSyntax\n};","map":null,"metadata":{},"sourceType":"script"}