{"ast":null,"code":"import _slicedToArray from\"/home/mistermboy/repositories/shex-author/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext,useEffect,useRef}from'react';import'yashe/dist/yashe.min.css';import{ShapesContext}from'../App';import YASHE from'yashe';import Editor from'../entities/editor';import yasheUtils from'../utils/yasheUtils';function EditorComp(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),yashe=_useState2[0],setYashe=_useState2[1];var textAreaRef=useRef(null);var context=useContext(ShapesContext);useEffect(function(){if(!yashe){var options={persistent:false,lineNumbers:true,viewportMargin:Infinity};var y=YASHE.fromTextArea(textAreaRef.current,options);y.on('blur',function(){if(!y.hasErrors(y)){replaceShapes();updatePrefixes();}});y.on('humanEvent',function(shapes){Editor.getInstance().draw(shapes);});y.on('prefixUpdate',function(){updatePrefixes();});y.on('themeChange',function(){changeThemeStyle();});y.on('delete',function(){replaceShapes();updatePrefixes();});y.on('upload',function(){//TimeOut necesary\nsetTimeout(function(){replaceShapes();updatePrefixes();},10);});y.on('keydown',function(){if(!y.hasErrors()){replaceShapes();updatePrefixes();}});//Fired after a key is handled through a key map\n//(for example \"Ctrl-Z\")\ny.on('keyHandled',function(){if(!y.hasErrors()){replaceShapes();updatePrefixes();}});y.setValue(yasheUtils.DEFAULT_SHAPE);y.refresh();setYashe(y);Editor.getInstance().setYashe(y);replaceShapes();updatePrefixes();}},[yashe]);var replaceShapes=function replaceShapes(){context.replaceShapes(yasheUtils.replaceShapes());};var updatePrefixes=function updatePrefixes(){context.updatePrefixes(yasheUtils.updatePrefixes());};var changeThemeStyle=function changeThemeStyle(){context.changeThemeStyle();};return React.createElement(\"div\",{className:\"col show\"},React.createElement(\"textarea\",{ref:textAreaRef}));}export default EditorComp;","map":{"version":3,"sources":["/home/mistermboy/repositories/shex-author/src/components/EditorComp.js"],"names":["React","useState","useContext","useEffect","useRef","ShapesContext","YASHE","Editor","yasheUtils","EditorComp","yashe","setYashe","textAreaRef","context","options","persistent","lineNumbers","viewportMargin","Infinity","y","fromTextArea","current","on","hasErrors","replaceShapes","updatePrefixes","shapes","getInstance","draw","changeThemeStyle","setTimeout","setValue","DEFAULT_SHAPE","refresh"],"mappings":"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","sourcesContent":["import React, {useState,useContext,useEffect,useRef} from 'react';\nimport 'yashe/dist/yashe.min.css';\nimport {ShapesContext} from '../App';\n\nimport YASHE from 'yashe';\nimport Editor from '../entities/editor';\n\nimport yasheUtils from '../utils/yasheUtils';\n\nfunction EditorComp() {\n\n  const [yashe,setYashe] = useState(null);\n  const textAreaRef = useRef(null);\n  const context = useContext(ShapesContext);\n\n  useEffect(() => {\n    \n        if (!yashe) {\n            const options = {\n                persistent:false,\n                lineNumbers: true,\n                viewportMargin: Infinity\n            }\n            \n            const y = YASHE.fromTextArea(\n                textAreaRef.current, \n                options)\n\n             y.on('blur', function() {\n                if(!y.hasErrors(y)){\n                    replaceShapes();\n                    updatePrefixes();\n                }\n            });\n\n\n             \n            y.on('humanEvent', function(shapes) {\n                Editor.getInstance().draw(shapes);\n            });\n\n\n            y.on('prefixUpdate', function() {\n                updatePrefixes();\n            });\n\n            y.on('themeChange', function() {\n                changeThemeStyle();\n            });\n\n            y.on('delete', function() {\n                replaceShapes();\n                updatePrefixes();\n\n            });\n\n            y.on('upload', function() {\n                //TimeOut necesary\n                setTimeout(function(){\n                  replaceShapes();\n                  updatePrefixes();\n                }, 10);\n                \n            });\n\n            y.on('keydown', function() {\n                if(!y.hasErrors()){\n                    replaceShapes();\n                    updatePrefixes();\n                }\n            });\n\n            //Fired after a key is handled through a key map\n            //(for example \"Ctrl-Z\")\n            y.on('keyHandled', function() {\n                if(!y.hasErrors()){\n                    replaceShapes();\n                    updatePrefixes();\n                }\n            });\n\n            y.setValue(yasheUtils.DEFAULT_SHAPE)\n            y.refresh();\n            setYashe(y);\n            \n            Editor.getInstance().setYashe(y);\n\n            replaceShapes();\n            updatePrefixes();\n        }\n    }, [yashe]\n    );\n\n    const replaceShapes = ()=>{\n        context.replaceShapes(yasheUtils.replaceShapes());\n    }\n\n    const updatePrefixes = ()=>{\n        context.updatePrefixes(yasheUtils.updatePrefixes());\n    }\n\n     const changeThemeStyle = ()=>{\n         context.changeThemeStyle();\n    }\n\n\n\n    return  (<div className='col show'>\n                <textarea ref={textAreaRef}/>\n            </div>            \n    );\n\n}\n\n\n\nexport default EditorComp;\n\n"]},"metadata":{},"sourceType":"module"}